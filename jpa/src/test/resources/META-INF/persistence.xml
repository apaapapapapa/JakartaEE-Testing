<!-- src/test/resources/META-INF/persistence.xml -->
<persistence xmlns="https://jakarta.ee/xml/ns/persistence" version="3.1">
  <persistence-unit name="testPU" transaction-type="JTA">
    <provider>org.hibernate.jpa.HibernatePersistenceProvider</provider>
    <class>com.example.task.Task</class>
    <properties>
      <!-- Hibernate を JTA 協調に -->
      <property name="hibernate.transaction.coordinator_class" value="jta"/>
      <!-- Hibernate 5.x の場合: org.hibernate.service.jta.platform.internal.JBossAppServerJtaPlatform
           Hibernate 6.x の場合: org.hibernate.engine.transaction.jta.platform.internal.JBossAppServerJtaPlatform -->
      <property name="hibernate.jta.platform"
                value="org.hibernate.engine.transaction.jta.platform.internal.JBossAppServerJtaPlatform"/>
      <!-- 上で作った Narayana 連携 ConnectionProvider -->
      <property name="hibernate.connection.provider_class"
                value="com.example.util.TransactionalConnectionProvider"/>
      <property name="hibernate.dialect" value="org.hibernate.dialect.H2Dialect"/>
      <property name="hibernate.hbm2ddl.auto" value="none"/>
      <property name="hibernate.show_sql" value="true"/>
      <property name="hibernate.format_sql" value="true"/>
    </properties>
  </persistence-unit>
</persistence>
